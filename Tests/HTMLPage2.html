<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8" />
	<title></title>
</head>
<body>
	<script type="text/javascript">

		/*
* Complete the 'cacheContents' function below.
*
* The function is expected to return an INTEGER_ARRAY.
* The function accepts 2D_INTEGER_ARRAY callLogs as parameter.
*/

		"use strict";

		function cacheContents(callLogs)
		{
			let itemPriorities = new Map();
			let cache = [];

			let sameSecondAccess = 0;
			let enterCacheThreshold = 5;
			let leaveCacheThreshold = 3;

			for (let i = 0; i < callLogs.length; i++)
			{
				let t = callLogs[i][0];
				let item = callLogs[i][1];

				sameSecondAccess++;
				if (i + 1 < callLogs.length && callLogs[i + 1][0] == t && callLogs[i + 1][1] == item)
				{
					continue;
				} else
				{
					let a = 2 * sameSecondAccess;

					let priority;
					if (itemPriorities.has(item))
					{
						//if (itemPriorities.get(item) < leaveCacheThreshold + t - 1)
						//{
						//	priority = a + t - 1;
						//} else
						//{
							a++; //rewars the access
							priority = itemPriorities.get(item) + a;
						//}
						itemPriorities.set(item, priority);
					} else
					{
						priority = a + t - 1; //t-1 is to make up the threshold increasing.
						itemPriorities.set(item, priority);
					}

					//enterCacheThreshold += t - previousTime;
					//leaveCacheThreshold += t - previousTime;

					if (priority > enterCacheThreshold + t - 1)
						cache.push(item);

					sameSecondAccess = 0;
				}
			}

			let itemsInCache = Array.from(itemPriorities.keys());
			for (let item of itemsInCache)
			{
				if (itemPriorities.get(item) < leaveCacheThreshold + callLogs[callLogs.length - 1][0] - 1)
					itemPriorities.delete(item);
			}


			return Array.from(itemPriorities.keys());
		}

		//cacheContents([[1, 1], [2, 1], [2, 1], [4, 2], [5, 2], [6, 2]]);
		//console.log(cacheContents([[1, 1], [2, 1], [3, 1], [4, 2], [5, 2], [6, 2]]));

	</script>
</body>
</html>